{"ast":null,"code":"import { Stitch, RemoteMongoClient //AnonymousCredential,\n, UserPasswordCredential, UserPasswordAuthProviderClient } from \"mongodb-stitch-browser-sdk\";\nexport const client = Stitch.initializeDefaultAppClient(\"ttk-ui-cvkwt\");\nexport const db = client.getServiceClient(RemoteMongoClient.factory, \"mongodb-atlas\").db(\"ttk-ui-db\");\nexport const collection = db.collection(\"test\");\nexport async function fetchUsers() {\n  const users = client.auth.listUsers();\n  console.log(users.length());\n  return await collection.find().asArray().then(users => users);\n}\nexport async function deleteUser(id) {\n  return await collection.deleteOne({\n    id\n  }).then(res => console.log(\"deleted\"));\n}\nexport async function logDB(email, password) {\n  const credential = new UserPasswordCredential(email, password);\n\n  try {\n    const authedUser = await client.auth.loginWithCredential(credential);\n    console.log(`successfully logged in with id: ${authedUser.id}`);\n    return {\n      success: true,\n      id: authedUser.id,\n      error: undefined\n    };\n  } catch (err) {\n    console.error(`login failed with error: ${err}`);\n    return {\n      success: false,\n      error: err\n    };\n  }\n}\n/* export function saveUser(environment) {\n  client.auth.loginWithCredential(new AnonymousCredential()).then(() => {\n    db.collection(environment)\n      .insertOne({\n        auth: \"asdnaksjdnasjdhasd\",\n        email: \"berkakgun@email.com\",\n        password: \"123456789\",\n      })\n      .then((result) =>\n        console.log(`Successfully inserted item with _id: ${result.insertedId}`)\n      )\n      .catch((err) => console.error(`Failed to insert item: ${err}`));\n  });\n} */\n\nexport async function SignUp(email, password) {\n  const emailPasswordClient = Stitch.defaultAppClient.auth.getProviderClient(UserPasswordAuthProviderClient.factory);\n\n  try {\n    await emailPasswordClient.registerWithEmail(email, password);\n    return {\n      success: true,\n      error: undefined\n    };\n  } catch (err) {\n    console.log(err);\n    return {\n      success: false,\n      error: err\n    };\n  }\n}\nexport async function confirmUser() {\n  const url = window.location.search;\n  const params = new URLSearchParams(url);\n  const token = params.get(\"token\");\n  const tokenId = params.get(\"tokenId\");\n  console.log(token, tokenId); // Confirm the user's email/password account\n\n  const emailPassClient = Stitch.defaultAppClient.auth.getProviderClient(UserPasswordAuthProviderClient.factory);\n  return emailPassClient.confirmUser(token, tokenId);\n}\nexport function resendConfirmation(email) {\n  const emailPassClient = Stitch.defaultAppClient.auth.getProviderClient(UserPasswordAuthProviderClient.factory);\n  emailPassClient.sendResetPasswordEmail(email).then(() => {\n    console.log(\"Successfully sent password reset email!\");\n  }).catch(err => {\n    console.log(\"Error sending password reset email:\", err);\n  });\n}","map":{"version":3,"sources":["/Users/berkakgun/Desktop/ttk/ttkui/src/api/db-actions.js"],"names":["Stitch","RemoteMongoClient","UserPasswordCredential","UserPasswordAuthProviderClient","client","initializeDefaultAppClient","db","getServiceClient","factory","collection","fetchUsers","users","auth","listUsers","console","log","length","find","asArray","then","deleteUser","id","deleteOne","res","logDB","email","password","credential","authedUser","loginWithCredential","success","error","undefined","err","SignUp","emailPasswordClient","defaultAppClient","getProviderClient","registerWithEmail","confirmUser","url","window","location","search","params","URLSearchParams","token","get","tokenId","emailPassClient","resendConfirmation","sendResetPasswordEmail","catch"],"mappings":"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","sourcesContent":["import {\n  Stitch,\n  RemoteMongoClient,\n  //AnonymousCredential,\n  UserPasswordCredential,\n  UserPasswordAuthProviderClient,\n} from \"mongodb-stitch-browser-sdk\";\n\nexport const client = Stitch.initializeDefaultAppClient(\"ttk-ui-cvkwt\");\n\nexport const db = client\n  .getServiceClient(RemoteMongoClient.factory, \"mongodb-atlas\")\n  .db(\"ttk-ui-db\");\n\nexport const collection = db.collection(\"test\");\n\nexport async function fetchUsers() {\n  const users = client.auth.listUsers();\n  console.log(users.length());\n  return await collection\n    .find()\n    .asArray()\n    .then((users) => users);\n}\n\nexport async function deleteUser(id) {\n  return await collection\n    .deleteOne({ id })\n    .then((res) => console.log(\"deleted\"));\n}\n\nexport async function logDB(email, password) {\n  const credential = new UserPasswordCredential(email, password);\n  try {\n    const authedUser = await client.auth.loginWithCredential(credential);\n    console.log(`successfully logged in with id: ${authedUser.id}`);\n    return { success: true, id: authedUser.id, error: undefined };\n  } catch (err) {\n    console.error(`login failed with error: ${err}`);\n    return { success: false, error: err };\n  }\n}\n\n/* export function saveUser(environment) {\n  client.auth.loginWithCredential(new AnonymousCredential()).then(() => {\n    db.collection(environment)\n      .insertOne({\n        auth: \"asdnaksjdnasjdhasd\",\n        email: \"berkakgun@email.com\",\n        password: \"123456789\",\n      })\n      .then((result) =>\n        console.log(`Successfully inserted item with _id: ${result.insertedId}`)\n      )\n      .catch((err) => console.error(`Failed to insert item: ${err}`));\n  });\n} */\n\nexport async function SignUp(email, password) {\n  const emailPasswordClient = Stitch.defaultAppClient.auth.getProviderClient(\n    UserPasswordAuthProviderClient.factory\n  );\n\n  try {\n    await emailPasswordClient.registerWithEmail(email, password);\n    return { success: true, error: undefined };\n  } catch (err) {\n    console.log(err);\n    return { success: false, error: err };\n  }\n}\n\nexport async function confirmUser() {\n  const url = window.location.search;\n  const params = new URLSearchParams(url);\n  const token = params.get(\"token\");\n  const tokenId = params.get(\"tokenId\");\n  console.log(token, tokenId);\n\n  // Confirm the user's email/password account\n  const emailPassClient = Stitch.defaultAppClient.auth.getProviderClient(\n    UserPasswordAuthProviderClient.factory\n  );\n  return emailPassClient.confirmUser(token, tokenId);\n}\n\nexport function resendConfirmation(email) {\n  const emailPassClient = Stitch.defaultAppClient.auth.getProviderClient(\n    UserPasswordAuthProviderClient.factory\n  );\n\n  emailPassClient\n    .sendResetPasswordEmail(email)\n    .then(() => {\n      console.log(\"Successfully sent password reset email!\");\n    })\n    .catch((err) => {\n      console.log(\"Error sending password reset email:\", err);\n    });\n}\n"]},"metadata":{},"sourceType":"module"}