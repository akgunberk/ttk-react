{"ast":null,"code":"import { useState } from \"react\";\nimport store from \"core/store/index\";\nimport { dispatchDefaultUser } from \"core/store/actions\";\nimport { collection, Application } from \"core/initApp\";\nimport { useSelector } from \"react-redux\";\nimport { getUserElements } from \"core/store/selectors\";\nimport { DefaultPayload } from \"./shared\";\nimport { With, Create } from \"./models\";\nexport function CreateCustomUser(environment) {\n  const payload = JSON.parse(JSON.stringify(DefaultPayload));\n  process.env[\"NODE_TLS_REJECT_UNAUTHORIZED\"] = \"0\"; // to prevent SSL\n\n  const url = `https://ttk.armut.${environment}/operate`;\n  const user = useSelector(getUserElements);\n  const [isLoading, setLoading] = useState(false);\n\n  const loadCustomUser = () => {\n    if (user.country) {\n      var _payload$commands;\n\n      (_payload$commands = payload.commands) === null || _payload$commands === void 0 ? void 0 : _payload$commands.push(With.COUNTRY);\n      payload.commandContext = { ...payload.commandContext,\n        countryId: user.country\n      };\n    }\n\n    if (user.job) {\n      var _payload$commands2;\n\n      (_payload$commands2 = payload.commands) === null || _payload$commands2 === void 0 ? void 0 : _payload$commands2.push(With.JOB);\n      payload.jobTestContext = {\n        operation: Create.JOB,\n        commands: [With.SERVICEID],\n        commandContext: {\n          serviceId: parseInt(user.service)\n        }\n      };\n\n      if (user.date) {\n        var _payload$jobTestConte;\n\n        (_payload$jobTestConte = payload.jobTestContext.commands) === null || _payload$jobTestConte === void 0 ? void 0 : _payload$jobTestConte.push(With.JOBDATE);\n        payload.jobTestContext.commandContext = { ...payload.jobTestContext.commandContext,\n          jobDate: user.date\n        };\n      }\n\n      if (user.deal === 1) {\n        var _payload$jobTestConte2;\n\n        (_payload$jobTestConte2 = payload.jobTestContext.commands) === null || _payload$jobTestConte2 === void 0 ? void 0 : _payload$jobTestConte2.push(With.DEAL);\n        payload.jobTestContext.commandContext = { ...payload.jobTestContext.commandContext,\n          jobDate: user.date\n        };\n        payload.jobTestContext.proTestContext = {\n          operation: Create.PRO,\n          commands: [With.CREDITCARD, With.BALANCE],\n          commandContext: {\n            proBalance: 10000\n          }\n        };\n      } else if (user.deal === 0) {\n        var _payload$jobTestConte3;\n\n        (_payload$jobTestConte3 = payload.jobTestContext.commands) === null || _payload$jobTestConte3 === void 0 ? void 0 : _payload$jobTestConte3.push(With.QUOTES);\n      }\n\n      console.log(payload);\n    }\n\n    setLoading(true);\n    fetch(url, {\n      method: \"POST\",\n      body: JSON.stringify(payload)\n    }).then(res => res.json()).then(user => {\n      const {\n        responseContext,\n        error\n      } = user;\n      const {\n        accessToken,\n        password,\n        model\n      } = responseContext[0];\n      const {\n        user_id,\n        email,\n        first_name\n      } = model;\n\n      if (!error) {\n        var _Application$currentU;\n\n        store.dispatch(dispatchDefaultUser({\n          user_id,\n          email,\n          password,\n          accessToken,\n          name: first_name\n        }));\n        collection.insertOne({\n          user_id: (_Application$currentU = Application.currentUser) === null || _Application$currentU === void 0 ? void 0 : _Application$currentU.id,\n          id: user_id,\n          email,\n          password,\n          accessToken,\n          first_name\n        }).then(result => console.log(`Successfully inserted item with _id: ${result.insertedId}`)).catch(err => console.error(`Failed to insert item: ${err}`));\n      }\n    }).finally(() => {\n      setLoading(false);\n    });\n  };\n\n  return [isLoading, loadCustomUser];\n}","map":{"version":3,"sources":["/Users/berkakgun/Desktop/ttk/ttkui/src/services/createCustomUser.tsx"],"names":["useState","store","dispatchDefaultUser","collection","Application","useSelector","getUserElements","DefaultPayload","With","Create","CreateCustomUser","environment","payload","JSON","parse","stringify","process","env","url","user","isLoading","setLoading","loadCustomUser","country","commands","push","COUNTRY","commandContext","countryId","job","JOB","jobTestContext","operation","SERVICEID","serviceId","parseInt","service","date","JOBDATE","jobDate","deal","DEAL","proTestContext","PRO","CREDITCARD","BALANCE","proBalance","QUOTES","console","log","fetch","method","body","then","res","json","responseContext","error","accessToken","password","model","user_id","email","first_name","dispatch","name","insertOne","currentUser","id","result","insertedId","catch","err","finally"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport store from \"core/store/index\";\nimport { dispatchDefaultUser } from \"core/store/actions\";\nimport { collection, Application } from \"core/initApp\";\nimport { useSelector } from \"react-redux\";\nimport { getUserElements } from \"core/store/selectors\";\nimport { DefaultPayload } from \"./shared\";\nimport { Payload, With, Create } from \"./models\";\n\nexport function CreateCustomUser(environment: string) {\n  const payload: Payload = JSON.parse(JSON.stringify(DefaultPayload));\n\n  process.env[\"NODE_TLS_REJECT_UNAUTHORIZED\"] = \"0\"; // to prevent SSL\n  const url = `https://ttk.armut.${environment}/operate`;\n\n  const user = useSelector(getUserElements);\n  const [isLoading, setLoading] = useState(false);\n\n  const loadCustomUser = () => {\n    if (user.country) {\n      payload.commands?.push(With.COUNTRY);\n      payload.commandContext = {\n        ...payload.commandContext,\n        countryId: user.country,\n      };\n    }\n    if (user.job) {\n      payload.commands?.push(With.JOB);\n      payload.jobTestContext = {\n        operation: Create.JOB,\n        commands: [With.SERVICEID],\n        commandContext: {\n          serviceId: parseInt(user.service),\n        },\n      };\n      if (user.date) {\n        payload.jobTestContext.commands?.push(With.JOBDATE);\n        payload.jobTestContext.commandContext = {\n          ...payload.jobTestContext.commandContext,\n          jobDate: user.date,\n        };\n      }\n      if (user.deal === 1) {\n        payload.jobTestContext.commands?.push(With.DEAL);\n        payload.jobTestContext.commandContext = {\n          ...payload.jobTestContext.commandContext,\n          jobDate: user.date,\n        };\n        payload.jobTestContext.proTestContext = {\n          operation: Create.PRO,\n          commands: [With.CREDITCARD, With.BALANCE],\n          commandContext: { proBalance: 10000 },\n        };\n      } else if (user.deal === 0) {\n        payload.jobTestContext.commands?.push(With.QUOTES);\n      }\n      console.log(payload);\n    }\n\n    setLoading(true);\n    fetch(url, {\n      method: \"POST\",\n      body: JSON.stringify(payload),\n    })\n      .then((res) => res.json())\n      .then((user) => {\n        const { responseContext, error } = user;\n        const { accessToken, password, model } = responseContext[0];\n        const { user_id, email, first_name } = model;\n        if (!error) {\n          store.dispatch(\n            dispatchDefaultUser({\n              user_id,\n              email,\n              password,\n              accessToken,\n              name: first_name,\n            })\n          );\n          collection\n            .insertOne({\n              user_id: Application.currentUser?.id,\n              id: user_id,\n              email,\n              password,\n              accessToken,\n              first_name,\n            })\n            .then((result) =>\n              console.log(\n                `Successfully inserted item with _id: ${result.insertedId}`\n              )\n            )\n            .catch((err) => console.error(`Failed to insert item: ${err}`));\n        }\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n  return [isLoading, loadCustomUser] as const;\n}\n"]},"metadata":{},"sourceType":"module"}