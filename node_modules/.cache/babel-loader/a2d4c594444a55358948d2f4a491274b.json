{"ast":null,"code":"import _regeneratorRuntime from\"/Users/berkakgun/Desktop/ttk/ttkui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/berkakgun/Desktop/ttk/ttkui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{Stitch,RemoteMongoClient//AnonymousCredential,\n,UserPasswordCredential,UserPasswordAuthProviderClient}from\"mongodb-stitch-browser-sdk\";export var client=Stitch.initializeDefaultAppClient(\"ttk-ui-cvkwt\");export var db=client.getServiceClient(RemoteMongoClient.factory,\"mongodb-atlas\").db(\"ttk-ui-db\");export var collection=db.collection(\"test\");export function fetchUsers(){return _fetchUsers.apply(this,arguments);}function _fetchUsers(){_fetchUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return collection.find().asArray().then(function(users){return users;});case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);}));return _fetchUsers.apply(this,arguments);}export function deleteUser(_x){return _deleteUser.apply(this,arguments);}function _deleteUser(){_deleteUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return collection.deleteOne({id:id}).then(function(res){return console.log(\"deleted\");});case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _deleteUser.apply(this,arguments);}export function logDB(_x2,_x3){return _logDB.apply(this,arguments);}/* export function saveUser(environment) {\n  client.auth.loginWithCredential(new AnonymousCredential()).then(() => {\n    db.collection(environment)\n      .insertOne({\n        auth: \"asdnaksjdnasjdhasd\",\n        email: \"berkakgun@email.com\",\n        password: \"123456789\",\n      })\n      .then((result) =>\n        console.log(`Successfully inserted item with _id: ${result.insertedId}`)\n      )\n      .catch((err) => console.error(`Failed to insert item: ${err}`));\n  });\n} */function _logDB(){_logDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(email,password){var credential,authedUser;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:credential=new UserPasswordCredential(email,password);_context3.prev=1;_context3.next=4;return client.auth.loginWithCredential(credential);case 4:authedUser=_context3.sent;console.log(\"successfully logged in with id: \".concat(authedUser.id));return _context3.abrupt(\"return\",{success:true,id:authedUser.id,error:undefined});case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);console.error(\"login failed with error: \".concat(_context3.t0));return _context3.abrupt(\"return\",{success:false,error:_context3.t0});case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return _logDB.apply(this,arguments);}export function SignUp(_x4,_x5){return _SignUp.apply(this,arguments);}function _SignUp(){_SignUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(email,password){var emailPasswordClient;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:emailPasswordClient=Stitch.defaultAppClient.auth.getProviderClient(UserPasswordAuthProviderClient.factory);_context4.prev=1;_context4.next=4;return emailPasswordClient.registerWithEmail(email,password);case 4:return _context4.abrupt(\"return\",{success:true,error:undefined});case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](1);console.log(_context4.t0);return _context4.abrupt(\"return\",{success:false,error:_context4.t0});case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[1,7]]);}));return _SignUp.apply(this,arguments);}export function confirmUser(){return _confirmUser.apply(this,arguments);}function _confirmUser(){_confirmUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var url,params,token,tokenId,emailPassClient;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:url=window.location.search;params=new URLSearchParams(url);token=params.get(\"token\");tokenId=params.get(\"tokenId\");console.log(token,tokenId);// Confirm the user's email/password account\nemailPassClient=Stitch.defaultAppClient.auth.getProviderClient(UserPasswordAuthProviderClient.factory);return _context5.abrupt(\"return\",emailPassClient.confirmUser(token,tokenId));case 7:case\"end\":return _context5.stop();}}},_callee5);}));return _confirmUser.apply(this,arguments);}export function resendConfirmation(email){var emailPassClient=Stitch.defaultAppClient.auth.getProviderClient(UserPasswordAuthProviderClient.factory);emailPassClient.sendResetPasswordEmail(email).then(function(){console.log(\"Successfully sent password reset email!\");}).catch(function(err){console.log(\"Error sending password reset email:\",err);});}","map":{"version":3,"sources":["/Users/berkakgun/Desktop/ttk/ttkui/src/api/db-actions.js"],"names":["Stitch","RemoteMongoClient","UserPasswordCredential","UserPasswordAuthProviderClient","client","initializeDefaultAppClient","db","getServiceClient","factory","collection","fetchUsers","find","asArray","then","users","deleteUser","id","deleteOne","res","console","log","logDB","email","password","credential","auth","loginWithCredential","authedUser","success","error","undefined","SignUp","emailPasswordClient","defaultAppClient","getProviderClient","registerWithEmail","confirmUser","url","window","location","search","params","URLSearchParams","token","get","tokenId","emailPassClient","resendConfirmation","sendResetPasswordEmail","catch","err"],"mappings":"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","sourcesContent":["import {\n  Stitch,\n  RemoteMongoClient,\n  //AnonymousCredential,\n  UserPasswordCredential,\n  UserPasswordAuthProviderClient,\n} from \"mongodb-stitch-browser-sdk\";\n\nexport const client = Stitch.initializeDefaultAppClient(\"ttk-ui-cvkwt\");\n\nexport const db = client\n  .getServiceClient(RemoteMongoClient.factory, \"mongodb-atlas\")\n  .db(\"ttk-ui-db\");\n\nexport const collection = db.collection(\"test\");\n\nexport async function fetchUsers() {\n  return await collection\n    .find()\n    .asArray()\n    .then((users) => users);\n}\n\nexport async function deleteUser(id) {\n  return await collection\n    .deleteOne({ id })\n    .then((res) => console.log(\"deleted\"));\n}\n\nexport async function logDB(email, password) {\n  const credential = new UserPasswordCredential(email, password);\n  try {\n    const authedUser = await client.auth.loginWithCredential(credential);\n    console.log(`successfully logged in with id: ${authedUser.id}`);\n    return { success: true, id: authedUser.id, error: undefined };\n  } catch (err) {\n    console.error(`login failed with error: ${err}`);\n    return { success: false, error: err };\n  }\n}\n\n/* export function saveUser(environment) {\n  client.auth.loginWithCredential(new AnonymousCredential()).then(() => {\n    db.collection(environment)\n      .insertOne({\n        auth: \"asdnaksjdnasjdhasd\",\n        email: \"berkakgun@email.com\",\n        password: \"123456789\",\n      })\n      .then((result) =>\n        console.log(`Successfully inserted item with _id: ${result.insertedId}`)\n      )\n      .catch((err) => console.error(`Failed to insert item: ${err}`));\n  });\n} */\n\nexport async function SignUp(email, password) {\n  const emailPasswordClient = Stitch.defaultAppClient.auth.getProviderClient(\n    UserPasswordAuthProviderClient.factory\n  );\n\n  try {\n    await emailPasswordClient.registerWithEmail(email, password);\n    return { success: true, error: undefined };\n  } catch (err) {\n    console.log(err);\n    return { success: false, error: err };\n  }\n}\n\nexport async function confirmUser() {\n  const url = window.location.search;\n  const params = new URLSearchParams(url);\n  const token = params.get(\"token\");\n  const tokenId = params.get(\"tokenId\");\n  console.log(token, tokenId);\n\n  // Confirm the user's email/password account\n  const emailPassClient = Stitch.defaultAppClient.auth.getProviderClient(\n    UserPasswordAuthProviderClient.factory\n  );\n  return emailPassClient.confirmUser(token, tokenId);\n}\n\nexport function resendConfirmation(email) {\n  const emailPassClient = Stitch.defaultAppClient.auth.getProviderClient(\n    UserPasswordAuthProviderClient.factory\n  );\n\n  emailPassClient\n    .sendResetPasswordEmail(email)\n    .then(() => {\n      console.log(\"Successfully sent password reset email!\");\n    })\n    .catch((err) => {\n      console.log(\"Error sending password reset email:\", err);\n    });\n}\n"]},"metadata":{},"sourceType":"module"}